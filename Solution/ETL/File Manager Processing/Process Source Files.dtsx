<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="3/7/2018 5:35:46 PM"
  DTS:CreationName=""
  DTS:CreatorComputerName="SFDATASQL"
  DTS:CreatorName="SFDATASQL\jeff.faseun"
  DTS:DTSID="{3C5D9C49-E405-4C94-B510-9F087F817B8C}"
  DTS:ExecutableType=""
  DTS:LastModifiedProductVersion="14.0.3002.92"
  DTS:LocaleID="1033"
  DTS:ObjectName="Process Source Files"
  DTS:PackageType="5"
  DTS:ProtectionLevel="2"
  DTS:VersionBuild="605"
  DTS:VersionGUID="{C646E748-B95D-4B06-A8DA-491D584B08A8}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7E0A2B78-B060-4FEC-92DD-7B057B1EFCC0}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="accepted_root_folder">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{107FA5DC-54A7-4447-ABA0-C51B33D980AE}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="agency_file_key">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{80449840-5841-4FE0-B35B-42188A2A1202}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="agency_key">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{9D8EB1DD-679C-45D8-B2EC-C3B8114E2E2A}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="archive_file_name">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{827B93AE-B044-4254-8787-627FA4BAD12A}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="archive_folder_path">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{AC56E918-13ED-4EF4-AE85-4B3042495B53}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="completed_ind">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{41CB407B-B207-4E47-BF76-DFAD069206BD}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="error_message">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{17095622-C2EB-4185-BB07-B15C47EA3AE0}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="file_created_dtm">
      <DTS:VariableValue
        DTS:DataType="7">3/28/2018 8:48:37 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F96D35F6-BE3E-46A3-AC70-49767F5E1D49}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_format_code">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{76E96584-5767-4BC0-9EA3-9BD70F972E63}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_guid">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4609B55D-E684-4791-8A28-ED4BF27643FE}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_hash">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E7730EB4-042F-4E5F-A132-48B6C428E2C4}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="file_modified_dtm">
      <DTS:VariableValue
        DTS:DataType="7">3/28/2018 8:48:53 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C70F76C6-A772-481B-85F3-E95498C458AB}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_name">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{53DC5793-AB49-4413-86FB-C8B211F3DF7F}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_path">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D3F40118-4732-4DBD-AC32-EF1D77BA9043}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="file_process_dtm">
      <DTS:VariableValue
        DTS:DataType="7">3/29/2018 11:12:23 AM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D683B389-32E4-4C4B-9A6E-8003D98895A0}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_process_error_message">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{0B77A6BB-E2C7-41A7-ADEE-04D6119314F3}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="file_process_success_flag">
      <DTS:VariableValue
        DTS:DataType="11">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D8993539-0649-47A8-B32B-096C6B49D106}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="folder_branch">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C952FF54-9673-4E09-90E2-2E61D28105C5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="folder_path">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A2A13AC2-1848-42C6-9068-EF195D48B655}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="package_error_flag">
      <DTS:VariableValue
        DTS:DataType="11">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{34E84F2A-A682-4104-95CA-B24211760488}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="(DT_STR, 8, 1252) @[System::VersionMajor] + &quot;.&quot; + (DT_STR, 8, 1252) @[System::VersionMinor] + &quot;.&quot; + (DT_STR, 8, 1252) @[System::VersionBuild]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="package_version">
      <DTS:VariableValue
        DTS:DataType="8">1.0.605</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{EFD1AEEE-3EB8-404A-85CC-D36DFF1D6D2B}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="process_batch_key">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4E7766BB-2D44-4807-A2E2-FAE254DBD372}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::ProjectName]  + &quot;::&quot; +   @[System::PackageName]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="process_uid">
      <DTS:VariableValue
        DTS:DataType="8">Source Files To File Manager::Process Source Files</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4F51D0E0-C911-458D-A2C0-0C9A39B03060}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="received_root_folder">
      <DTS:VariableValue
        DTS:DataType="8">C:\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E8B026B2-5D01-40B9-9BBA-B4495C8697E9}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="rejected_root_folder">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Read Configuration"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Reads path configurations from database"
      DTS:DTSID="{58125CC8-3D23-4FAB-8323-F0675B0E3792}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Read Configuration"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
          SQLTask:SqlStatementSource="SELECT received_folder_path, accepted_folder_path, rejected_folder_path FROM [dbo].[config] WHERE config_key = 0"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="received_folder_path"
            SQLTask:DtsVariableName="User::received_root_folder" />
          <SQLTask:ResultBinding
            SQLTask:ResultName="accepted_folder_path"
            SQLTask:DtsVariableName="User::accepted_root_folder" />
          <SQLTask:ResultBinding
            SQLTask:ResultName="rejected_folder_path"
            SQLTask:DtsVariableName="User::rejected_root_folder" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Recurse Through Received Folders"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Note that the folder path is from the dbo.config table and not the C:\ path you see in this task"
      DTS:DTSID="{5BD11666-F4F4-4243-80B5-F51C83586515}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:ObjectName="Recurse Through Received Folders">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.ForEachFileEnumerator"
        DTS:DTSID="{9BD5AB73-4263-482A-BE66-787588853085}"
        DTS:ObjectName="{9BD5AB73-4263-482A-BE66-787588853085}">
        <DTS:PropertyExpression
          DTS:Name="Directory">@[User::received_root_folder]</DTS:PropertyExpression>
        <DTS:ObjectData>
          <ForEachFileEnumeratorProperties>
            <FEFEProperty
              Folder="C:\" />
            <FEFEProperty
              FileSpec="*.*" />
            <FEFEProperty
              FileNameRetrievalType="0" />
            <FEFEProperty
              Recurse="-1" />
          </ForEachFileEnumeratorProperties>
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{4995A01E-F444-4739-A8EE-58BE8FF4EFBC}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="file_extension">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{EFB00398-F07A-488A-AD21-2C8397E4E04C}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="file_format_header_row">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{77CBDB99-98C9-4FFB-9E7A-527E7F3E9DFC}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="notification_message">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{8A39D249-643E-4511-94D3-878887A87472}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="notification_subject">
          <DTS:VariableValue
            DTS:DataType="8">File Import Notification</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{DB4B2D0F-470A-4372-A4CC-338AACDA36D5}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="notification_to">
          <DTS:VariableValue
            DTS:DataType="8">notification@default.com</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{BBCDCA39-3832-492E-8E2F-83E51E6181D2}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="send_notification_flag">
          <DTS:VariableValue
            DTS:DataType="17">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Archive File"
          DTS:CreationName="Microsoft.ScriptTask"
          DTS:Description="Script Task"
          DTS:DTSID="{C1BB97F9-26DF-430D-BEC2-1ACD3ECDC71A}"
          DTS:ExecutableType="Microsoft.ScriptTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Archive File"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <ScriptProject
              Name="ST_72e34d651082476d932c076e29ff67c3"
              VSTAMajorVersion="14"
              VSTAMinorVersion="0"
              Language="CSharp"
              ReadOnlyVariables="User::accepted_root_folder,User::archive_file_name,User::file_path,User::file_process_success_flag,User::folder_branch,User::rejected_root_folder"
              ReadWriteVariables="User::archive_folder_path">
              <ProjectItem
                Name="Properties\AssemblyInfo.cs"
                Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_72e34d651082476d932c076e29ff67c3")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("ST_72e34d651082476d932c076e29ff67c3")]
[assembly: AssemblyCopyright("Copyright @  2018")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
              <ProjectItem
                Name="Properties\Resources.resx"
                Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
              <ProjectItem
                Name="ST_72e34d651082476d932c076e29ff67c3.csproj"
                Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{11e327a8-6ce3-406a-a977-ecd5b0b1c946}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ST_72e34d651082476d932c076e29ff67c3</RootNamespace>
    <AssemblyName>ST_72e34d651082476d932c076e29ff67c3</AssemblyName>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
  </PropertyGroup>

  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>

  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>

  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=13.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=13.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup>

  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
         <Generator>ResXFileCodeGenerator</Generator>
         <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
             <AutoGen>True</AutoGen>
         <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
         <Generator>SettingsSingleFileGenerator</Generator>
         <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
         <AutoGen>True</AutoGen>
         <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
    <Compile Include="ScriptMain.cs">
         <SubType>Code</SubType>
    </Compile>
  </ItemGroup>

  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />

  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="ScriptTask"
                           HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}"
                           ApplicationType="usd"
                           Language="cs"
                           TemplatesPath=""
                           DebugInfoCommandLine=""
                           DebugInfoWorkingDir=""
                           IconImageList=""/>
        <Host Name="ScriptTask" GeneratedNamespace="$safeprojectname" IconIndex="">
        </Host>
        <ProjectClient>
            <HostIdentifier>SSIS_ST130</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></ProjectItem>
              <ProjectItem
                Name="ScriptMain.cs"
                Encoding="UTF8"><![CDATA[using System;
using System.IO;
using Microsoft.SqlServer.Dts.Runtime;

namespace ST_6dcce2eeeaad4a6cafb8c4bfaf485614
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
    public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
    {

        public void Main()
        {

            // load values from variables
            string FilePath = Dts.Variables["User::file_path"].Value.ToString();
            string FolderBranch = Dts.Variables["User::folder_branch"].Value.ToString();
            string ArchiveFileName = Dts.Variables["User::archive_file_name"].Value.ToString();
            string RejectedRootFolderPath = Dts.Variables["User::rejected_root_folder"].Value.ToString();
            string AcceptedRootFolderPath = Dts.Variables["User::accepted_root_folder"].Value.ToString();
            bool FileProcessSuccessFlag = (bool)Dts.Variables["User::file_process_success_flag"].Value;

            // determine where archive target file path
            string ArchiveRootFolderPath = (FileProcessSuccessFlag) ? AcceptedRootFolderPath : RejectedRootFolderPath;
            string ArchiveFilePath = Path.Combine(ArchiveRootFolderPath, FolderBranch, ArchiveFileName);

            // get the folder path for the archvie target file
            string ArchiveFolderPath = Path.GetDirectoryName(ArchiveFilePath);

            // ensure the target director exists
            if (!Directory.Exists(ArchiveFolderPath))
            {
                Directory.CreateDirectory(ArchiveFolderPath);
            }

            // move the file to the archive location
            File.Move(FilePath, ArchiveFilePath);

            Dts.Variables["User::archive_folder_path"].Value = ArchiveFolderPath;

            Dts.TaskResult = (int)ScriptResults.Success;
        }


        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

    }
}]]></ProjectItem>
              <ProjectItem
                Name="Project"
                Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="3.0" schemaVersion="1.0">
	<msb:PropertyGroup>
		<msb:Language>msBuild</msb:Language>
		<msb:CodeName>ST_72e34d651082476d932c076e29ff67c3</msb:CodeName>
		<msb:DisplayName>ST_72e34d651082476d932c076e29ff67c3</msb:DisplayName>
		<msb:ProjectId>{7D068843-550E-4C85-8586-F62C63CD5C50}</msb:ProjectId>
	</msb:PropertyGroup>
	<msb:ItemGroup>
		<msb:Project Include="ST_72e34d651082476d932c076e29ff67c3.csproj"/>
		<msb:File Include="Properties\Settings.settings"/>
		<msb:File Include="Properties\AssemblyInfo.cs"/>
		<msb:File Include="Properties\Resources.resx"/>
		<msb:File Include="Properties\Resources.Designer.cs"/>
		<msb:File Include="Properties\Settings.Designer.cs"/>
		<msb:File Include="ScriptMain.cs"/>
	</msb:ItemGroup>
</c:Project>]]></ProjectItem>
              <ProjectItem
                Name="Properties\Settings.Designer.cs"
                Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_72e34d651082476d932c076e29ff67c3.Properties.Settings.get_Default():ST_72e34d651082476d932c076e29ff67c3.Properties.Sett" +
    "ings")]

namespace ST_72e34d651082476d932c076e29ff67c3.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
              <ProjectItem
                Name="Properties\Settings.settings"
                Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
              <ProjectItem
                Name="Properties\Resources.Designer.cs"
                Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_72e34d651082476d932c076e29ff67c3.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_72e34d651082476d932c076e29ff67c3.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_72e34d651082476d932c076e29ff67c3.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_72e34d651082476d932c076e29ff67c3.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_72e34d651082476d932c076e29ff67c3.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
              <BinaryItem
                Name="ST_72e34d651082476d932c076e29ff67c3.dll">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAPtX9FoAAAAAAAAAAOAAIiALATAAABIAAAAIAAAAAAAApjAA
AAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACAAAAAAgAAAAAAAAMAYIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAFQwAABPAAAAAEAAAHgEAAAAAAAAAAAAAAAAAAAA
AAAAAGAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAArBAAAAAgAAAAEgAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAHgEAAAAQAAAAAYAAAAUAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAGAAAAACAAAAGgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAACI
MAAAAAAAAEgAAAACAAUA3CEAAMANAAABAAAAAAAAAJwvAAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAABMwBAAXAQAAAQAAEQIoEAAACm8RAAAKcgEAAHBvEgAACm8T
AAAKbxQAAAoCKBAAAApvEQAACnIhAABwbxIAAApvEwAACm8UAAAKCgIoEAAACm8RAAAKckkAAHBv
EgAACm8TAAAKbxQAAAoLAigQAAAKbxEAAApyeQAAcG8SAAAKbxMAAApvFAAACgwCKBAAAApvEQAA
CnKvAABwbxIAAApvEwAACm8UAAAKDQIoEAAACm8RAAAKcuUAAHBvEgAACm8TAAAKpRsAAAEtAwgr
AQkGBygVAAAKEwQRBCgWAAAKEwURBSgXAAAKLQgRBSgYAAAKJhEEKBkAAAoCKBAAAApvEQAACnIl
AQBwbxIAAAoRBW8aAAAKAigQAAAKFm8bAAAKKh4CKBwAAAoqHgIoHQAACiqufgEAAAQtHnJZAQBw
0AMAAAIoHgAACm8fAAAKcyAAAAqAAQAABH4BAAAEKhp+AgAABCoeAoACAAAEKhp+AwAABCoeAigh
AAAKKi5zCAAABoADAAAEKgAAAEJTSkIBAAEAAAAAAAwAAAB2NC4wLjMwMzE5AAAAAAUAbAAAAAAE
AAAjfgAAbAQAAOgFAAAjU3RyaW5ncwAAAABUCgAAzAEAACNVUwAgDAAAEAAAACNHVUlEAAAAMAwA
AJABAAAjQmxvYgAAAAAAAAACAAABVx2iAQkDAAAA+gEzABYAAAEAAAAiAAAABQAAAAYAAAAJAAAA
AQAAACEAAAACAAAAEAAAAAEAAAACAAAAAwAAAAQAAAABAAAABAAAAAEAAAABAAAAAADVAwEAAAAA
AAYAcQK7BAYAAAO7BAYAvQGoBA8ALwUAAAYA6gFbBAYAVAJbBAYANQJbBAYA5wJbBAYAkQJbBAYA
qgJbBAYAAQJbBAYAHAI9AwoAxQKEAwoAPAGEAwYADQQGBAYAoAGoBAYAqQUGBAYAiwTbBAYAbQRG
BA4AcAG/Aw4A0QG/Aw4AWAExBAYAhQG7BAoArQOEAxIAcQXfABIAnADfAAYAHgQGBAYAYANSAAYA
3gVSAAYAeQRSAAYAyQBSAAYABwEGBAYApQAGBAYAzwVbBAAAAABJAAAAAAABAAEAAQAQACYEJQA5
AAEAAQAAABAA4gQ+BUUAAQADAAABEAB7BT4FWQADAAcAAwEAAJQFAAA9AAQACgARABIEkQARACwB
lQARAIwAmQAGBnsAnQBWgIQFoABWgAwBoABQIAAAAACGACwEBgABAHMhAAAAAIYYmwQGAAEAeyEA
AAAAgxibBAYAAQCDIQAAAACTCIcEpAABAK8hAAAAAJMIFAGpAAEAtiEAAAAAkwggAa4AAQC+IQAA
AACWCLAFtAACAMUhAAAAAIYYmwQGAAIAzSEAAAAAkRihBLkAAgAAAAEAMgMJAJsEAQARAJsEBgAZ
AJsECgApAJsEEAAxAJsEEAA5AJsEEABBAJsEEABJAJsEEABRAJsEEABZAJsEEABhAJsEEABpAJsE
BgCBAJsEBgCpAJsEFQC5AJsEBgBxAIwFJADBAG0FKQDJAP0DLgDRAB4DNACJAFcDOADhAP8APADh
AM4AQwDpAKIFSADpANgFTQD5ADgDUwDRACgDWQDBALwFAQBxAJsEBgCJAJsEBgABAbcAXgABAcsF
ZwCRAJsEbQCxAJsEBgAIABQAhwAIABgAjAApAHMA9AAuAAsAzAAuABMA1QAuABsA9AAuACMA/QAu
ACsAJgEuADMAJgEuADsAJgEuAEMA/QAuAEsALAEuAFMAJgEuAFsAQwFDAGMAjABJAHMA9ABhAHsA
jABjAGsAjAAbAAMAAQAEAAMAAACLBL0AAAA0AcIAAAC0BccAAgAEAAMAAgAFAAUAAQAGAAUAAgAH
AAcABIAAAAEAAAAwGh1KAAAAAAAAAQAAAAQAAAAAAAAAAAAAAHUAgwAAAAAADQAAAAAAAAAAAAAA
fgBlAwAAAAAEAAAAAAAAAAAAAAB1AAYEAAAAAA0AAAAAAAAAAAAAAH4AXAAAAAAAAAAAAAEAAADs
BAAABQACAAAAAAAAU1RfNzJlMzRkNjUxMDgyNDc2ZDkzMmMwNzZlMjlmZjY3YzMAU1RfNmRjY2Uy
ZWVlYWFkNGE2Y2FmYjhjNGJmYWY0ODU2MTQAPE1vZHVsZT4AU3lzdGVtLklPAE1pY3Jvc29mdC5T
cWxTZXJ2ZXIuTWFuYWdlZERUUwB2YWx1ZV9fAG1zY29ybGliAGRlZmF1bHRJbnN0YW5jZQBWYXJp
YWJsZQBSdW50aW1lVHlwZUhhbmRsZQBHZXRUeXBlRnJvbUhhbmRsZQBGaWxlAEdldERpcmVjdG9y
eU5hbWUATWljcm9zb2Z0LlNxbFNlcnZlci5EdHMuUnVudGltZQBDb21iaW5lAFR5cGUARmFpbHVy
ZQBnZXRfQ3VsdHVyZQBzZXRfQ3VsdHVyZQByZXNvdXJjZUN1bHR1cmUAVlNUQVJUU2NyaXB0T2Jq
ZWN0TW9kZWxCYXNlAEFwcGxpY2F0aW9uU2V0dGluZ3NCYXNlAEVkaXRvckJyb3dzYWJsZVN0YXRl
AENvbXBpbGVyR2VuZXJhdGVkQXR0cmlidXRlAERlYnVnZ2VyTm9uVXNlckNvZGVBdHRyaWJ1dGUA
RGVidWdnYWJsZUF0dHJpYnV0ZQBFZGl0b3JCcm93c2FibGVBdHRyaWJ1dGUAQXNzZW1ibHlUaXRs
ZUF0dHJpYnV0ZQBBc3NlbWJseVRyYWRlbWFya0F0dHJpYnV0ZQBUYXJnZXRGcmFtZXdvcmtBdHRy
aWJ1dGUAQXNzZW1ibHlDb25maWd1cmF0aW9uQXR0cmlidXRlAEFzc2VtYmx5RGVzY3JpcHRpb25B
dHRyaWJ1dGUAQ29tcGlsYXRpb25SZWxheGF0aW9uc0F0dHJpYnV0ZQBBc3NlbWJseVByb2R1Y3RB
dHRyaWJ1dGUAQXNzZW1ibHlDb3B5cmlnaHRBdHRyaWJ1dGUAU1NJU1NjcmlwdFRhc2tFbnRyeVBv
aW50QXR0cmlidXRlAEFzc2VtYmx5Q29tcGFueUF0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0
eUF0dHJpYnV0ZQBnZXRfVmFsdWUAc2V0X1ZhbHVlAHZhbHVlAE1vdmUAU3lzdGVtLlJ1bnRpbWUu
VmVyc2lvbmluZwBUb1N0cmluZwBQYXRoAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuU2NyaXB0VGFzawBN
aWNyb3NvZnQuU3FsU2VydmVyLkR0cy5UYXNrcy5TY3JpcHRUYXNrAFNjcmlwdE9iamVjdE1vZGVs
AFN5c3RlbS5Db21wb25lbnRNb2RlbABTVF83MmUzNGQ2NTEwODI0NzZkOTMyYzA3NmUyOWZmNjdj
My5kbGwAZ2V0X0l0ZW0AU3lzdGVtAEVudW0AcmVzb3VyY2VNYW4AQm9vbGVhbgBTY3JpcHRNYWlu
AFN5c3RlbS5Db25maWd1cmF0aW9uAFN5c3RlbS5HbG9iYWxpemF0aW9uAFN5c3RlbS5SZWZsZWN0
aW9uAEN1bHR1cmVJbmZvAERpcmVjdG9yeUluZm8AZ2V0X1Jlc291cmNlTWFuYWdlcgAuY3RvcgAu
Y2N0b3IAU3lzdGVtLkRpYWdub3N0aWNzAFN5c3RlbS5SdW50aW1lLkNvbXBpbGVyU2VydmljZXMA
U3lzdGVtLlJlc291cmNlcwBTVF83MmUzNGQ2NTEwODI0NzZkOTMyYzA3NmUyOWZmNjdjMy5Qcm9w
ZXJ0aWVzLlJlc291cmNlcy5yZXNvdXJjZXMARGVidWdnaW5nTW9kZXMAU1RfNzJlMzRkNjUxMDgy
NDc2ZDkzMmMwNzZlMjlmZjY3YzMuUHJvcGVydGllcwBnZXRfVmFyaWFibGVzAFNldHRpbmdzAFN1
Y2Nlc3MAZ2V0X0R0cwBTY3JpcHRSZXN1bHRzAEV4aXN0cwBPYmplY3QAZ2V0X0RlZmF1bHQAc2V0
X1Rhc2tSZXN1bHQAZ2V0X0Fzc2VtYmx5AENyZWF0ZURpcmVjdG9yeQAAH1UAcwBlAHIAOgA6AGYA
aQBsAGUAXwBwAGEAdABoAAAnVQBzAGUAcgA6ADoAZgBvAGwAZABlAHIAXwBiAHIAYQBuAGMAaAAA
L1UAcwBlAHIAOgA6AGEAcgBjAGgAaQB2AGUAXwBmAGkAbABlAF8AbgBhAG0AZQAANVUAcwBlAHIA
OgA6AHIAZQBqAGUAYwB0AGUAZABfAHIAbwBvAHQAXwBmAG8AbABkAGUAcgAANVUAcwBlAHIAOgA6
AGEAYwBjAGUAcAB0AGUAZABfAHIAbwBvAHQAXwBmAG8AbABkAGUAcgAAP1UAcwBlAHIAOgA6AGYA
aQBsAGUAXwBwAHIAbwBjAGUAcwBzAF8AcwB1AGMAYwBlAHMAcwBfAGYAbABhAGcAADNVAHMAZQBy
ADoAOgBhAHIAYwBoAGkAdgBlAF8AZgBvAGwAZABlAHIAXwBwAGEAdABoAABxUwBUAF8ANwAyAGUA
MwA0AGQANgA1ADEAMAA4ADIANAA3ADYAZAA5ADMAMgBjADAANwA2AGUAMgA5AGYAZgA2ADcAYwAz
AC4AUAByAG8AcABlAHIAdABpAGUAcwAuAFIAZQBzAG8AdQByAGMAZQBzAAAAuLcUbpOeZ0itMdeR
kcdUqQAEIAEBCAMgAAEFIAEBEREEIAEBDgUgAQERUQgHBg4ODg4ODgQgABJhBCAAEmUFIAESaRwD
IAAcAyAADgYAAw4ODg4EAAEODgQAAQIOBQABEnkOBQACAQ4OBCABARwIAAESgIERgIUFIAASgIkH
IAIBDhKAiQi3elxWGTTgiQiJhF3NgIDMkQQAAAAABAEAAAADBhJJAwYSTQMGEhACBggDBhEUBAAA
EkkEAAASTQUAAQESTQQAABIQAwAAAQQIABJJBAgAEk0ECAASEAgBAAgAAAAAAB4BAAEAVAIWV3Jh
cE5vbkV4Y2VwdGlvblRocm93cwEIAQACAAAAAAAoAQAjU1RfNzJlMzRkNjUxMDgyNDc2ZDkzMmMw
NzZlMjlmZjY3YzMAAAUBAAAAABYBABFDb3B5cmlnaHQgQCAgMjAxOAAASQEAGi5ORVRGcmFtZXdv
cmssVmVyc2lvbj12NC41AQBUDhRGcmFtZXdvcmtEaXNwbGF5TmFtZRIuTkVUIEZyYW1ld29yayA0
LjUAAAC0AAAAzsrvvgEAAACRAAAAbFN5c3RlbS5SZXNvdXJjZXMuUmVzb3VyY2VSZWFkZXIsIG1z
Y29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49
Yjc3YTVjNTYxOTM0ZTA4OSNTeXN0ZW0uUmVzb3VyY2VzLlJ1bnRpbWVSZXNvdXJjZVNldAIAAAAA
AAAAAAAAAFBBRFBBRFC0AAAAfDAAAAAAAAAAAAAAljAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AIgwAAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAEAEAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAAADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAA
AEgAAABYQAAAGgQAAAAAAAAAAAAAGgQ0AAAAVgBTAF8AVgBFAFIAUwBJAE8ATgBfAEkATgBGAE8A
AAAAAL0E7/4AAAEAAAABAB1KMBoAAAEAHUowGj8AAAAAAAAABAAAAAIAAAAAAAAAAAAAAAAAAABE
AAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQABAAAAFQAcgBhAG4AcwBsAGEAdABpAG8A
bgAAAAAAAACwBHoDAAABAFMAdAByAGkAbgBnAEYAaQBsAGUASQBuAGYAbwAAAFYDAAABADAAMAAw
ADAAMAA0AGIAMAAAABoAAQABAEMAbwBtAG0AZQBuAHQAcwAAAAAAAAAiAAEAAQBDAG8AbQBwAGEA
bgB5AE4AYQBtAGUAAAAAAAAAAABwACQAAQBGAGkAbABlAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAA
AAAAUwBUAF8ANwAyAGUAMwA0AGQANgA1ADEAMAA4ADIANAA3ADYAZAA5ADMAMgBjADAANwA2AGUA
MgA5AGYAZgA2ADcAYwAzAAAAPgAPAAEARgBpAGwAZQBWAGUAcgBzAGkAbwBuAAAAAAAxAC4AMAAu
ADYANwAwADQALgAxADgAOQA3ADMAAAAAAHAAKAABAEkAbgB0AGUAcgBuAGEAbABOAGEAbQBlAAAA
UwBUAF8ANwAyAGUAMwA0AGQANgA1ADEAMAA4ADIANAA3ADYAZAA5ADMAMgBjADAANwA2AGUAMgA5
AGYAZgA2ADcAYwAzAC4AZABsAGwAAABIABIAAQBMAGUAZwBhAGwAQwBvAHAAeQByAGkAZwBoAHQA
AABDAG8AcAB5AHIAaQBnAGgAdAAgAEAAIAAgADIAMAAxADgAAAAqAAEAAQBMAGUAZwBhAGwAVABy
AGEAZABlAG0AYQByAGsAcwAAAAAAAAAAAHgAKAABAE8AcgBpAGcAaQBuAGEAbABGAGkAbABlAG4A
YQBtAGUAAABTAFQAXwA3ADIAZQAzADQAZAA2ADUAMQAwADgAMgA0ADcANgBkADkAMwAyAGMAMAA3
ADYAZQAyADkAZgBmADYANwBjADMALgBkAGwAbAAAAGgAJAABAFAAcgBvAGQAdQBjAHQATgBhAG0A
ZQAAAAAAUwBUAF8ANwAyAGUAMwA0AGQANgA1ADEAMAA4ADIANAA3ADYAZAA5ADMAMgBjADAANwA2
AGUAMgA5AGYAZgA2ADcAYwAzAAAAQgAPAAEAUAByAG8AZAB1AGMAdABWAGUAcgBzAGkAbwBuAAAA
MQAuADAALgA2ADcAMAA0AC4AMQA4ADkANwAzAAAAAABGAA8AAQBBAHMAcwBlAG0AYgBsAHkAIABW
AGUAcgBzAGkAbwBuAAAAMQAuADAALgA2ADcAMAA0AC4AMQA4ADkANwAzAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAADAAAAKgwAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</BinaryItem>
            </ScriptProject>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Custom Row Processing"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{65058960-8A64-495F-885B-8A9733500115}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Custom Row Processing"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="EXEC master_custom_afr_processing ?, ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::agency_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::agency_file_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::file_name"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Get Agency Info"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Uses folder_branch to get Agency info"
          DTS:DTSID="{EA3272F7-45B0-4938-A10D-219E32B5234F}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Get Agency Info"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="/* Using the folder_branch variable, we determine the agency,&#xA;  default file format, and the header row for that file format and&#xA;  return the values.&#xA;*/&#xA;DECLARE @file_format_code as varchar(50)&#xA;DECLARE @agency_key as int&#xA;DECLARE @file_format_header_row as int&#xA;&#xA;SELECT&#xA;@file_format_code  = agency.default_file_format_code&#xA;,@agency_key = agency.agency_key&#xA;, @file_format_header_row = [file_format].file_format_header_row&#xA;FROM&#xA;dbo.agency INNER JOIN dbo.[file_format]&#xA;ON agency.default_file_format_code = [file_format].file_format_code&#xA;WHERE agency.folder_branch = ?&#xA;&#xA;SELECT @file_format_code file_format_code, @agency_key agency_key, @file_format_header_row file_format_header_row&#xA;"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_format_code"
                SQLTask:DtsVariableName="User::file_format_code" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="agency_key"
                SQLTask:DtsVariableName="User::agency_key" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_format_header_row"
                SQLTask:DtsVariableName="User::file_format_header_row" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::folder_branch"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Get File Extension"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Gets the extension for the current file"
          DTS:DTSID="{50E5F500-9676-4EA5-BDED-B235BD450EAC}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Get File Extension"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="-- Gets file extension out of the file path&#xA;&#xA;/* Since we're referencing the same parameter twice, it's best&#xA; to add it to a variable. */&#xA;DECLARE @file_path as varchar(1000)&#xA;SET @file_path = ?&#xA;&#xA;/* To find the extension, we reverse the file path and search for a&#xA;   period (.)  This gives us the location of the extension regardless&#xA;   of the number of characters - xlsx and xls and any other&#xA;  extension of any reasonable length is fine. */&#xA;&#xA;SELECT LOWER(REVERSE(LEFT(REVERSE(@file_path), CHARINDEX('.', REVERSE(@file_path))))) file_extension&#xA;&#xA;/*  When it returns the extension, it includes the period (.) and is&#xA;   returned in lowercase.  The SSIS expressions are case sensitive.&#xA;*/"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_extension"
                SQLTask:DtsVariableName="User::file_extension" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::file_path"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Get File Info"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Pulls 8 values into the stream of variables"
          DTS:DTSID="{78891EBB-CB35-4848-B950-EE5909C3406C}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Get File Info"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="EXEC get_File_Info ?, ?"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_hash"
                SQLTask:DtsVariableName="User::file_hash" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_guid"
                SQLTask:DtsVariableName="User::file_guid" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_name"
                SQLTask:DtsVariableName="User::file_name" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="folder_path"
                SQLTask:DtsVariableName="User::folder_path" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="folder_branch"
                SQLTask:DtsVariableName="User::folder_branch" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_created_dtm"
                SQLTask:DtsVariableName="User::file_created_dtm" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_modified_dtm"
                SQLTask:DtsVariableName="User::file_modified_dtm" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="archive_file_name"
                SQLTask:DtsVariableName="User::archive_file_name" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::file_path"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="1000" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::received_root_folder"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="1000" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Insert Agency File"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Inserts a record of the current file"
          DTS:DTSID="{94188572-B47F-4B59-9077-274D66AA2EC1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Insert Agency File"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="/* Inserts a record of the file we are currently processing into&#xA;  agency_file.  Most of these values come from variables&#xA;  already defined. */&#xA;INSERT INTO dbo.agency_file&#xA;(&#xA;  [agency_key]&#xA;, [file_format_code]&#xA;, [file_path]&#xA;, [file_name]&#xA;, [folder_path]&#xA;, [folder_branch]&#xA;, [file_guid]&#xA;, [file_hash]&#xA;, [archive_file_name]&#xA;, [file_created_dtm]&#xA;, [file_modified_dtm]&#xA;, [create_timestamp]&#xA;, [modify_timestamp]&#xA;, [process_batch_key]&#xA;)&#xA;OUTPUT Inserted.agency_file_key&#xA;VALUES &#xA;(&#xA;  ? -- {0} [agency_key]&#xA;, ? -- {1} [file_format_code]&#xA;, ? -- {2} [file_path]&#xA;, ? -- {3} [file_name]&#xA;, ? -- {4} [folder_path]&#xA;, ? -- {5} [folder_branch]&#xA;, ? -- {6} [file_guid]&#xA;, ? -- {7} [file_hash]&#xA;, ? -- {8} [archive_file_name]&#xA;, ? -- {9} [file_created_dtm]&#xA;, ? -- {10} [file_modified_dtm]&#xA;, CURRENT_TIMESTAMP -- [create_timestamp]&#xA;, CURRENT_TIMESTAMP -- [modify_timestamp]&#xA;, ? -- {11} [process_batch_key]&#xA;)"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="agency_file_key"
                SQLTask:DtsVariableName="User::agency_file_key" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="User::file_name"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="200" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="5"
                SQLTask:DtsVariableName="User::folder_branch"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="200" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="7"
                SQLTask:DtsVariableName="User::file_hash"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="32" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="9"
                SQLTask:DtsVariableName="User::file_created_dtm"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="7"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="10"
                SQLTask:DtsVariableName="User::file_modified_dtm"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="7"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::file_path"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="1000" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="11"
                SQLTask:DtsVariableName="User::process_batch_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="131"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::file_format_code"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="20" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::agency_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="User::folder_path"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="1000" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="6"
                SQLTask:DtsVariableName="User::file_guid"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="50" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="8"
                SQLTask:DtsVariableName="User::archive_file_name"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="200" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Load Agency File Rows"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Inserts the rows for the current file"
          DTS:DTSID="{5FC43615-E04A-41D0-A16D-498335694D85}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Load Agency File Rows"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="EXEC load_agency_file_rows ?, ?, ?"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_process_dtm"
                SQLTask:DtsVariableName="User::file_process_dtm" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_process_error_message"
                SQLTask:DtsVariableName="User::file_process_error_message" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="file_process_success_flag"
                SQLTask:DtsVariableName="User::file_process_success_flag" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::file_format_header_row"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::agency_file_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::process_batch_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Mark Notification Sent"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{00A6A980-7A76-404B-ADE6-DDB0C26EC961}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Mark Notification Sent"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="UPDATE agency_file SET notification_sent_ind = 1 WHERE agency_file_key = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::agency_file_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Reset File Extension"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:Description="Expression Task"
          DTS:DTSID="{1ddb279d-fb0a-42bf-a1e4-b4bab666b2be}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reset File Extension"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::file_extension] =  NULL(DT_STR, 20, 1252)" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Reset File Format Code"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:Description="Expression Task"
          DTS:DTSID="{361C8880-DADA-4AA8-82A8-4CE45AAD3951}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reset File Format Code"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::file_format_code] =  NULL(DT_STR, 20, 1252)" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Reset File Header Row"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:Description="Expression Task"
          DTS:DTSID="{E5FF3BD1-58D2-49BA-A8DD-0A17D70419CD}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reset File Header Row"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::file_format_header_row] = 1" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Retrieve Notification Info"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{F5967C4B-E3B0-4DE1-A988-3359ACA135BC}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Retrieve Notification Info"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="get_File_Manager_notification ?, ?"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="notification_to"
                SQLTask:DtsVariableName="User::notification_to" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="notification_subject"
                SQLTask:DtsVariableName="User::notification_subject" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="notification_message"
                SQLTask:DtsVariableName="User::notification_message" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="send_notification"
                SQLTask:DtsVariableName="User::send_notification_flag" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::agency_file_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::file_process_success_flag"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="17"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Send Notification Email"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{003CB079-FF5D-405F-BC2C-667693182235}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Notification Email"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="EXEC send_File_Manager_notification ?, ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::notification_message"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::notification_to"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::notification_subject"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Recurse Through Received Folders\Update Agency File For Archive"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{695CD14D-AE09-42AF-8B47-97B2FCF9E397}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update Agency File For Archive"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:FilterKind="0" />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BA76BA1-444B-46FE-A43F-A11FD096EA2A}"
              SQLTask:SqlStatementSource="UPDATE dbo.[agency_file]  SET&#xA;  archive_folder_path = ?&#xA;, process_dtm = ?&#xA;, process_success_ind = CONVERT(BIT, ?)&#xA;, process_error_message = ?&#xA;WHERE &#xA;agency_file_key = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="User::agency_file_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="131"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::archive_folder_path"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="1000" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::file_process_dtm"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="7"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="User::file_process_error_message"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="1000" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::file_process_success_flag"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="17"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{E26AAAC5-F053-49E1-8C18-F23DD70351E4}"
          DTS:From="Package\Recurse Through Received Folders\Insert Agency File"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Recurse Through Received Folders\Load Agency File Rows" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{99508CAC-FABC-47C8-9DF0-C01BB1B9C6AF}"
          DTS:EvalOp="1"
          DTS:Expression="(ISNULL(@[User::file_format_code]) == FALSE) &amp;&amp; (@[User::agency_key] &gt;0)"
          DTS:From="Package\Recurse Through Received Folders\Get Agency Info"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Recurse Through Received Folders\Insert Agency File" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 10]"
          DTS:CreationName=""
          DTS:DTSID="{BDAAD556-BB0C-4A7C-B7FC-B5F99BBFF32E}"
          DTS:From="Package\Recurse Through Received Folders\Get File Info"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 10"
          DTS:To="Package\Recurse Through Received Folders\Get Agency Info" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 12]"
          DTS:CreationName=""
          DTS:DTSID="{E800C2DC-2ECE-4D78-A142-1C8B1BFA37E4}"
          DTS:EvalOp="3"
          DTS:Expression="@[User::file_extension] == (DT_STR, 40, 1252) &quot;.xlsx&quot; || @[User::file_extension] == (DT_STR, 40, 1252) &quot;.xls&quot;"
          DTS:From="Package\Recurse Through Received Folders\Get File Extension"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 12"
          DTS:To="Package\Recurse Through Received Folders\Get File Info" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 13]"
          DTS:CreationName=""
          DTS:DTSID="{B525C3C0-0CCB-478B-8D7F-203B92FA9718}"
          DTS:From="Package\Recurse Through Received Folders\Reset File Extension"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 13"
          DTS:To="Package\Recurse Through Received Folders\Reset File Format Code" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 14]"
          DTS:CreationName=""
          DTS:DTSID="{9D8D53A5-A75A-48FD-9AB2-750B5D2C64F9}"
          DTS:From="Package\Recurse Through Received Folders\Custom Row Processing"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 14"
          DTS:To="Package\Recurse Through Received Folders\Archive File" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{6880F465-4DC7-4E19-9E2F-FDC6540A8680}"
          DTS:From="Package\Recurse Through Received Folders\Reset File Format Code"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Recurse Through Received Folders\Reset File Header Row" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 3]"
          DTS:CreationName=""
          DTS:DTSID="{E78972BE-0C89-48D2-B142-89049BDA8EB5}"
          DTS:From="Package\Recurse Through Received Folders\Load Agency File Rows"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 3"
          DTS:To="Package\Recurse Through Received Folders\Custom Row Processing" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 4]"
          DTS:CreationName=""
          DTS:DTSID="{ABCCFC12-8428-4A41-A1C5-840FA3DBCC7E}"
          DTS:From="Package\Recurse Through Received Folders\Update Agency File For Archive"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 4"
          DTS:To="Package\Recurse Through Received Folders\Retrieve Notification Info" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 5]"
          DTS:CreationName=""
          DTS:DTSID="{B7B1DB31-18B4-4E99-8872-694C4E6A6256}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::send_notification_flag] == 1"
          DTS:From="Package\Recurse Through Received Folders\Retrieve Notification Info"
          DTS:ObjectName="Constraint 5"
          DTS:To="Package\Recurse Through Received Folders\Send Notification Email" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 6]"
          DTS:CreationName=""
          DTS:DTSID="{3FA1E839-44A4-453B-998F-07C5C800BC0D}"
          DTS:From="Package\Recurse Through Received Folders\Archive File"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 6"
          DTS:To="Package\Recurse Through Received Folders\Update Agency File For Archive" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 7]"
          DTS:CreationName=""
          DTS:DTSID="{BDA0EAAE-F3E6-4400-BF9B-06C06799E0FA}"
          DTS:From="Package\Recurse Through Received Folders\Reset File Header Row"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 7"
          DTS:To="Package\Recurse Through Received Folders\Get File Extension" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 8]"
          DTS:CreationName=""
          DTS:DTSID="{35279926-002C-433F-BC33-EF01C6771948}"
          DTS:From="Package\Recurse Through Received Folders\Send Notification Email"
          DTS:ObjectName="Constraint 8"
          DTS:To="Package\Recurse Through Received Folders\Mark Notification Sent" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 9]"
          DTS:CreationName=""
          DTS:DTSID="{91EBBF73-10E9-4C9B-B63C-34ED3DDDDF31}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::send_notification_flag] != 1"
          DTS:From="Package\Recurse Through Received Folders\Retrieve Notification Info"
          DTS:ObjectName="Constraint 9"
          DTS:To="Package\Recurse Through Received Folders\Mark Notification Sent" />
      </DTS:PrecedenceConstraints>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{7B3D7C15-9D6D-4D85-9BE2-BA6FB31340C4}"
          DTS:ObjectName="{7B3D7C15-9D6D-4D85-9BE2-BA6FB31340C4}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::file_path" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{EC53E4A6-9C12-476C-A598-46728C52FB84}"
      DTS:From="Package\Read Configuration"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Recurse Through Received Folders" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{D98571A2-5AE4-4857-BAD2-5ED8C2F0B770}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{EF9BB8ED-6828-41F4-A036-91D7CA973E72}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Log Process Batch Error"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:DTSID="{DE6B08BB-1155-436D-97AC-4D0C166B4E98}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Log Process Batch Error"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; Â© 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BE61CE8-DD91-4404-B6D0-31FDFE93C3B4}"
              SQLTask:SqlStatementSource="EXEC cdm.process_batch_error_log &#xA;@process_batch_key = ?, &#xA;@error_scope = ?, &#xA;@error_number = ?, &#xA;@error_message = ?, &#xA;@error_type_cd = 'E'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::process_batch_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="0" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::SourceName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="0" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="System::ErrorCode"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="0" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="0" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Turn On Package Error Flag"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:DTSID="{4C51BB7D-6C1F-4A71-B95B-638D9E529636}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Turn On Package Error Flag"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2012; Â© 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::package_error_flag]=TRUE" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{16FD7B96-C065-4C4C-A65C-EB955F0B5ECC}"
          DTS:From="Package.EventHandlers[OnError]\Turn On Package Error Flag"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package.EventHandlers[OnError]\Log Process Batch Error" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPostExecute]"
      DTS:CreationName="OnPostExecute"
      DTS:DTSID="{8C126856-5421-41E0-A8C6-FFA2417C5E9F}"
      DTS:EventID="0"
      DTS:EventName="OnPostExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{D6A615BC-249D-419D-92B7-0EAAFFFC910B}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPostExecute]\Assign Completed Indicator"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:DTSID="{EA1FA9F8-C2F4-4EF5-9E2C-8A4782E3BCB5}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Assign Completed Indicator"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2012; Â© 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::completed_ind] =  @[User::package_error_flag] ? 0 : 1" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPostExecute]\Conclude Process Batch"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:DTSID="{0385510D-4181-4FE3-B097-9D8E480A52C2}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Conclude Process Batch"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; Â© 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BE61CE8-DD91-4404-B6D0-31FDFE93C3B4}"
              SQLTask:SqlStatementSource="EXEC cdm.process_batch_conclude&#xA;        @completed_ind = ?&#xA;      , @process_batch_key = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::completed_ind"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="17"
                SQLTask:ParameterSize="0" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::process_batch_key"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="0" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPostExecute]\Entry Point"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:Description="Expression Task"
          DTS:DTSID="{291CDD16-EF28-423C-A239-8A3A0EBD357D}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Entry Point"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::completed_ind]" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnPostExecute].PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{3C0E6850-865E-49F9-8FF9-06E1AF163A7C}"
          DTS:EvalOp="1"
          DTS:Expression="@[System::SourceID] == @[System::PackageID]"
          DTS:From="Package.EventHandlers[OnPostExecute]\Entry Point"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package.EventHandlers[OnPostExecute]\Assign Completed Indicator" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnPostExecute].PrecedenceConstraints[Constraint_EXP - assign completed indicator_To_SQL - conclude process batch]"
          DTS:CreationName=""
          DTS:DTSID="{37C4E9FB-A189-4B6D-9C72-42F3E74DE3AF}"
          DTS:From="Package.EventHandlers[OnPostExecute]\Assign Completed Indicator"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint_EXP - assign completed indicator_To_SQL - conclude process batch"
          DTS:To="Package.EventHandlers[OnPostExecute]\Conclude Process Batch" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPreExecute]"
      DTS:CreationName="OnPreExecute"
      DTS:DTSID="{39DE1DD1-1C53-4C47-88D7-C5E817847DC0}"
      DTS:EventID="1153914880"
      DTS:EventName="OnPreExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{D21078B4-B374-4079-8939-A2AC47C0860F}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPreExecute]\Entry Point"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:Description="Expression Task"
          DTS:DTSID="{A342213A-E333-43D1-9604-4C25D69EF9B6}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Entry Point"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[User::completed_ind]" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPreExecute]\Initiate Process Batch"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:DTSID="{2D3E0F2A-0ACE-4056-BA7A-60D98DEEDD2F}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Initiate Process Batch"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; Â© 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{5BE61CE8-DD91-4404-B6D0-31FDFE93C3B4}"
              SQLTask:SqlStatementSource="EXEC cdm.process_batch_initiate&#xA;@process_uid = ?, &#xA;@workflow_name = ?, &#xA;@workflow_guid = ?,&#xA;@workflow_version= ?"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="process_batch_key"
                SQLTask:DtsVariableName="User::process_batch_key" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::process_uid"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::PackageName"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="User::package_version"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="System::PackageID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{06BE69CB-10E2-43DF-84FD-93B02BF98D65}"
          DTS:EvalOp="1"
          DTS:Expression="@[System::SourceID] == @[System::PackageID]"
          DTS:From="Package.EventHandlers[OnPreExecute]\Entry Point"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package.EventHandlers[OnPreExecute]\Initiate Process Batch" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph" xmlns:mssge="clr-namespace:Microsoft.SqlServer.Graph.Extended;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
        <NodeLayout
          Size="168.666666666667,41.3333333333334"
          Id="Package\Read Configuration"
          TopLeft="95.8722253409696,57.1065362143111" />
        <NodeLayout
          Size="133.333333333334,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Archive File"
          TopLeft="50.516337553634,712.42856680602" />
        <NodeLayout
          Size="192,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Custom Row Processing"
          TopLeft="27.9444434717298,634.044439516332" />
        <NodeLayout
          Size="156,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Get Agency Info"
          TopLeft="47.3885596496102,284.00513392976" />
        <NodeLayout
          Size="164,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Get File Extension"
          TopLeft="49.1249987116705,96.499997869134" />
        <NodeLayout
          Size="137.333333333334,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Get File Info"
          TopLeft="61.9027742128819,214.555548194382" />
        <NodeLayout
          Size="163.333333333334,41.3333333333334"
          Id="Package\Recurse Through Received Folders\Insert Agency File"
          TopLeft="50.1996379028894,410.179266533583" />
        <NodeLayout
          Size="188,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Load Agency File Rows"
          TopLeft="33.0833301978811,552.361102994448" />
        <NodeLayout
          Size="184,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Mark Notification Sent"
          TopLeft="70.4330713779199,1040.07258024444" />
        <NodeLayout
          Size="173.333333333334,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Reset File Extension"
          TopLeft="62.1264220605107,23.4059334141989" />
        <NodeLayout
          Size="189.333333333334,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Reset File Format Code"
          TopLeft="277.064681936773,24.1836637198776" />
        <NodeLayout
          Size="185.333333333334,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Reset File Header Row"
          TopLeft="511.249992381782,27.5777775349881" />
        <NodeLayout
          Size="196.666666666667,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Retrieve Notification Info"
          TopLeft="17.3347560612917,851.795705875318" />
        <NodeLayout
          Size="188,42.6666666666667"
          Id="Package\Recurse Through Received Folders\Send Notification Email"
          TopLeft="190.722216737767,915.999986414115" />
        <NodeLayout
          Size="168,41.3333333333334"
          Id="Package\Recurse Through Received Folders\Update Agency File For Archive"
          TopLeft="34.8163043398296,788.228886456972" />
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 1]"
          TopLeft="128.627432109583,326.671800596427">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,83.5074659371563"
              Start="0,0"
              End="0,76.0074659371563">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,76.0074659371563" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,30.0037329685782,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 10]"
          TopLeft="127.979000264579,257.222214861049">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,26.7829190687114"
              Start="0,0"
              End="0,19.2829190687114">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.2829190687114" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 12]"
          TopLeft="130.84721979561,139.166664535801">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,75.3888836585813"
              Start="0,0"
              End="0,67.8888836585813">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,67.8888836585813" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,25.9444418292907,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 13]"
          TopLeft="235.459755393844,45.1281319003716">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="41.604926542929,0"
              Start="0,0"
              End="34.104926542929,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="34.104926542929,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 14]"
          TopLeft="120.563723846015,676.711106182999">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,35.7174606230209"
              Start="0,0"
              End="0,28.2174606230209">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.2174606230209" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 2]"
          TopLeft="466.398015270106,47.2140539607662">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="44.8519771116757,0"
              Start="0,0"
              End="37.3519771116757,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="37.3519771116757,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 3]"
          TopLeft="125.513886834805,595.027769661115">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,39.0166698552179"
              Start="0,0"
              End="0,31.5166698552179">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.5166698552179" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 4]"
          TopLeft="202.81630433983,808.895553123638">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="11.1851183881288,58.4557083072355"
              Start="0,0"
              End="18.6851183881288,58.4557083072355">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="29.6851183881288,0" />
                  <mssgle:CubicBezierSegment
                    Point1="29.6851183881288,0"
                    Point2="33.6851183881288,0"
                    Point3="33.6851183881288,4" />
                  <mssgle:LineSegment
                    End="33.6851183881288,54.4557083072355" />
                  <mssgle:CubicBezierSegment
                    Point1="33.6851183881288,54.4557083072355"
                    Point2="33.6851183881288,58.4557083072355"
                    Point3="29.6851183881288,58.4557083072355" />
                  <mssgle:LineSegment
                    End="18.6851183881288,58.4557083072355" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 5]"
          TopLeft="214.001422727958,873.129039208652">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="70.7207940098089,42.870947205463"
              Start="0,0"
              End="70.7207940098089,35.370947205463">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="66.7207940098089,0" />
                  <mssgle:CubicBezierSegment
                    Point1="66.7207940098089,0"
                    Point2="70.7207940098089,0"
                    Point3="70.7207940098089,4" />
                  <mssgle:LineSegment
                    End="70.7207940098089,35.370947205463" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="62.7207940098089,-22,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 6]"
          TopLeft="117.999654280065,755.095233472687">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,33.1336529842849"
              Start="0,0"
              End="0,25.6336529842849">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.6336529842849" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 7]"
          TopLeft="603.916659048449,70.2444442016548">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="-472.791660336778,26.2555536674792"
              Start="0,0"
              End="-472.791660336778,18.7555536674792">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.12777683373962" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.12777683373962"
                    Point2="0,13.1277768337396"
                    Point3="-4,13.1277768337396" />
                  <mssgle:LineSegment
                    End="-468.791660336778,13.1277768337396" />
                  <mssgle:CubicBezierSegment
                    Point1="-468.791660336778,13.1277768337396"
                    Point2="-472.791660336778,13.1277768337396"
                    Point3="-472.791660336778,17.1277768337396" />
                  <mssgle:LineSegment
                    End="-472.791660336778,18.7555536674792" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 8]"
          TopLeft="284.722216737767,958.666653080781">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="-92.9558120265139,81.40592716366"
              Start="0,0"
              End="-92.9558120265139,73.90592716366">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,44.4224911576943" />
                  <mssgle:CubicBezierSegment
                    Point1="0,44.4224911576943"
                    Point2="0,48.4224911576943"
                    Point3="-4,48.4224911576943" />
                  <mssgle:LineSegment
                    End="-88.9558120265139,48.4224911576943" />
                  <mssgle:CubicBezierSegment
                    Point1="-88.9558120265139,48.4224911576943"
                    Point2="-92.9558120265139,48.4224911576943"
                    Point3="-92.9558120265139,52.4224911576943" />
                  <mssgle:LineSegment
                    End="-92.9558120265139,73.90592716366" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint 9]"
          TopLeft="115.668089394625,894.462372541985">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="17.4316486499616,145.610207702456"
              Start="0,0"
              End="17.4316486499616,138.110207702456">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,82.612968374737" />
                  <mssgle:CubicBezierSegment
                    Point1="0,82.612968374737"
                    Point2="0,86.612968374737"
                    Point3="4,86.612968374737" />
                  <mssgle:LineSegment
                    End="13.4316486499616,86.612968374737" />
                  <mssgle:CubicBezierSegment
                    Point1="13.4316486499616,86.612968374737"
                    Point2="17.4316486499616,86.612968374737"
                    Point3="17.4316486499616,90.612968374737" />
                  <mssgle:LineSegment
                    End="17.4316486499616,138.110207702456" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0.715824324980801,91.612968374737,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Only proceeds further if agency key is greater than zero and file format is not null"
          ParentId="Package\Recurse Through Received Folders"
          Size="678.666666666667,46"
          Id="320cb9e6-2eb2-4636-865c-58d2d0fd4a20"
          TopLeft="231.08056472453,342.450000045201">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="If notifications are disabled for a particular file or situation, they are not sent, but they are still marked as &quot;Sent&quot;"
          ParentId="Package\Recurse Through Received Folders"
          Size="574.666666666667,37.3333333333334"
          Id="a5721d6e-0702-4a5e-b2ba-3046cdb8355a"
          TopLeft="407.777770608663,968.555542253786">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo>
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Resets variables at the beginning of the loop in order to prevent conflicts"
          ParentId="Package\Recurse Through Received Folders"
          Size="609.333333333334,46"
          Id="34cd5e85-0316-4dc1-82e6-307e1283e12b"
          TopLeft="735.166653069357,26.3888861639632">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Gets information about the file including folder branch, created/modified times, hash, guid, and file name for archiving"
          ParentId="Package\Recurse Through Received Folders"
          Size="970.666666666667,46"
          Id="bffbd717-c0aa-4367-8135-4a3bcbebbd2d"
          TopLeft="233.654197282326,215.683707614706">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Using the folder branch, identifies the agency this file belongs to and returns the agency key and file header row"
          ParentId="Package\Recurse Through Received Folders"
          Size="924,46"
          Id="edcc88dc-8795-41d0-a821-42a51ea0b9fa"
          TopLeft="232.265308414133,280.76704010215">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Only proceeds further if the current file extension is .xls or .xlsx"
          ParentId="Package\Recurse Through Received Folders"
          Size="534,46"
          Id="d7addaa8-36d4-466e-95b0-8fe595e4b8fe"
          TopLeft="234.333329856396,155.944440893001">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Determines the file extension of the current file and loads into the @file_extension variable"
          ParentId="Package\Recurse Through Received Folders"
          Size="752,46"
          Id="9540642b-b478-4797-b7f9-b9ce8ea730c9"
          TopLeft="234.541663112119,93.8333308925232">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Inserts a record of the current file we are processing into the table dbo.agency_file."
          ParentId="Package\Recurse Through Received Folders"
          Size="694.666666666667,46"
          Id="46f04ed5-4b60-40ae-b5fd-ae6891721553"
          TopLeft="229.834752894795,407.155926731028">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <EdgeLayout
          Id="Package\Recurse Through Received Folders.PrecedenceConstraints[Constraint]"
          TopLeft="129.474817383719,451.512599866916">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,100.848503127532"
              Start="0,0"
              End="0,93.3485031275316">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,93.3485031275316" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1425.33333333334,1244"
          Size="1425.33333333334,1286.66666666667"
          Id="Package\Recurse Through Received Folders"
          TopLeft="37.113887894295,169.694117496913" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="180.205558674303,98.4398695476444">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="569.574995886659,71.2542479492686"
              Start="0,0"
              End="569.574995886659,63.7542479492686">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.6271239746343" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.6271239746343"
                    Point2="0,35.6271239746343"
                    Point3="4,35.6271239746343" />
                  <mssgle:LineSegment
                    End="565.574995886659,35.6271239746343" />
                  <mssgle:CubicBezierSegment
                    Point1="565.574995886659,35.6271239746343"
                    Point2="569.574995886659,35.6271239746343"
                    Point3="569.574995886659,39.6271239746343" />
                  <mssgle:LineSegment
                    End="569.574995886659,63.7542479492686" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Reads the paths to search for dropped files and the paths to send rejected and accepted files from the dbo.config table"
          ParentId="Package"
          Size="977.333333333334,46"
          Id="8590e15c-4a48-4c78-afde-55a8e8bb27e5"
          TopLeft="272.569440382843,55.2777770674892">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="Processes each file found in the received folder path individually"
          ParentId="Package"
          Size="538.666666666667,46"
          Id="1bfe431f-d062-47a9-98d0-457ba55117e8"
          TopLeft="793.749988172204,116.999999457597">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="18"
              Color="#FF000000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnError]\Log Process Batch Error"
          TopLeft="NaN,NaN" />
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnError]\Turn On Package Error Flag"
          TopLeft="NaN,NaN" />
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          TopLeft="NaN,NaN">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="{x:Null}"
              Start="0,0"
              End="0,0">
              <mssgle:Curve.Segments>
                <x:Null />
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPostExecute]\Assign Completed Indicator"
          TopLeft="NaN,NaN" />
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPostExecute]\Conclude Process Batch"
          TopLeft="NaN,NaN" />
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPostExecute]\Entry Point"
          TopLeft="NaN,NaN" />
        <EdgeLayout
          Id="Package.EventHandlers[OnPostExecute].PrecedenceConstraints[Constraint]"
          TopLeft="NaN,NaN">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="{x:Null}"
              Start="0,0"
              End="0,0">
              <mssgle:Curve.Segments>
                <x:Null />
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.EventHandlers[OnPostExecute].PrecedenceConstraints[Constraint_EXP - assign completed indicator_To_SQL - conclude process batch]"
          TopLeft="NaN,NaN">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="{x:Null}"
              Start="0,0"
              End="0,0">
              <mssgle:Curve.Segments>
                <x:Null />
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPreExecute]\Entry Point"
          TopLeft="NaN,NaN" />
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPreExecute]\Initiate Process Batch"
          TopLeft="NaN,NaN" />
        <EdgeLayout
          Id="Package.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="NaN,NaN">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="{x:Null}"
              Start="0,0"
              End="0,0">
              <mssgle:Curve.Segments>
                <x:Null />
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>